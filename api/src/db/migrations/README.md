# Database Migrations

This directory contains database migration scripts generated by Drizzle Kit.

## Migration Workflow

1. **Update Drizzle Schema**: Edit schema files in `src/db/schema/`
2. **Generate Migration**: Run `bun run db:generate`
3. **Review Migration**: Check generated SQL files in this directory
4. **Apply Migration**: Run `bun run db:migrate` to apply migrations
5. **Push Schema (Dev)**: For development, use `bun run db:push` to sync schema directly

## Migration Best Practices

- Always test migrations in development first
- Review generated SQL before applying
- Create backups before running migrations in production
- Use descriptive migration names
- Keep migrations small and focused
- Never edit existing migrations (create new ones instead)

## Migration Naming Convention

Drizzle Kit generates migrations with timestamps. Manual SQL files should follow:
- `0001_descriptive_name.sql`
- `0002_another_feature.sql`

## Rollback Strategy

Drizzle doesn't support automatic rollbacks. To rollback:
1. Create a new migration that reverses the changes
2. Or manually restore from backup
3. Rollback SQL files (e.g., `*_rollback.sql`) are provided for reference

## Multi-Tenancy Considerations

- All tenant-scoped tables must include `tenant_id`
- Indexes should include `tenant_id` for performance
- Foreign keys should respect tenant boundaries
- Row-level security policies should be added via migrations
